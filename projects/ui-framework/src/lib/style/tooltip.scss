$tooltip-color: $grey-700;
$tooltip-arrow-size: 12px;
$toolti-offset: 10px;

%tooltip-body {
  background-color: $tooltip-color;
  max-width: 350px;
  overflow: visible;
  overflow-wrap: break-word;
  padding: 8px 15px;
  margin: $toolti-offset 0;
  border-radius: $border-radius;
  @include b-body($color: white, $style: normal, $addCssVars: false);
  text-align: center;
  white-space: normal;

  @media (max-width: 400px) {
    max-width: 80vw;
  }
}

%tooltip-arrow-common {
  @include pseudo;
  position: absolute;
  left: calc(50% - #{$tooltip-arrow-size/2});
}

.mat-tooltip[class] {
  @extend %tooltip-body;

  &:before {
    @extend %tooltip-arrow-common;
  }

  // position above
  &[style*='center bottom'],
  &[style*='50% 100% 0px'] {
    &:before {
      @include arrow-down($tooltip-arrow-size, $tooltip-color);
      top: 100%;
    }
  }

  // position below
  &[style*='center top'],
  &[style*='50% 0% 0px'] {
    &:before {
      @include arrow-up($tooltip-arrow-size, $tooltip-color);
      bottom: 100%;
    }
  }

  // text align

  &.text-left {
    text-align: left;
  }

  &.text-right {
    text-align: right;
  }

  // wrap

  &.no-wrap {
    white-space: nowrap;
    max-width: 65vw;
  }

  &.pre-wrap {
    white-space: pre-line;
  }
}

@keyframes tooltip-apprnc {
  0% {
    opacity: 0;
    transform: translateX(-50%) scale(0);
  }
  50% {
    opacity: 0.5;
    transform: translateX(-50%) scale(0.99);
  }
  100% {
    opacity: 1;
    transform: translateX(-50%) scale(1);
  }
}
@keyframes tooltip-apprnc-btt {
  0% {
    opacity: 0;
    transform: scale(0);
  }
  50% {
    opacity: 0.5;
    transform: scale(0.99);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}
@keyframes tooltip-arrow-apprnc {
  0% {
    opacity: 0;
    transform: translateY(-12px) scale(0);
  }
  50% {
    opacity: 0.65;
    transform: translateY(0) scale(0.99);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}
@keyframes tooltip-arrow-apprnc-below {
  0% {
    opacity: 0;
    transform: translateY(12px) scale(0);
  }
  50% {
    opacity: 0.65;
    transform: translateY(0) scale(0.99);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

[data-tooltip] {
  position: relative;
  outline: 0;

  &:after {
    display: block;
    content: attr(data-tooltip);
    @extend %tooltip-body;
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    z-index: 10;
    white-space: normal;
    @include animate(tooltip-apprnc, 0.1s, 0.3s);
    animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
  }

  &:before {
    @extend %tooltip-arrow-common;
  }

  &:not(:hover),
  &[data-tooltip=''] {
    &:before,
    &:after {
      display: none;
    }
  }

  // position above (default)
  & {
    &:after {
      bottom: 100%;
      transform-origin: center bottom;
    }
    &:before {
      @include arrow-down($tooltip-arrow-size, $tooltip-color);
      bottom: calc(100% + #{$toolti-offset - $tooltip-arrow-size/2});
      transform-origin: center bottom;
      @include animate(tooltip-arrow-apprnc, 0.1s, 0.3s);
    }
  }

  // position below
  &[data-tooltip-position='below'] {
    &:after {
      bottom: auto;
      top: 100%;
      transform-origin: center top;
    }
    &:before {
      border-top: 0;
      border-bottom: ($tooltip-arrow-size/2) solid $tooltip-color;
      bottom: auto;
      top: calc(100% + #{$toolti-offset - $tooltip-arrow-size/2});
      transform-origin: center top;
      animation-name: tooltip-arrow-apprnc-below;
    }
  }

  // text align

  &.text-left,
  &[data-tooltip-align='left'] {
    &:after {
      text-align: left;
    }
  }

  &.text-right,
  &[data-tooltip-align='right'] {
    &:after {
      text-align: right;
    }
  }

  // wrap

  &.no-wrap,
  &[data-tooltip-wrap='nowrap'] {
    &:after {
      white-space: nowrap;
      max-width: 65vw;
    }
  }

  &.pre-wrap,
  &[data-tooltip-wrap='pre'] {
    &:after {
      white-space: pre-line;
    }
  }

  // show on

  &[data-tooltip-show='focus'] {
    &:before,
    &:after {
      animation-delay: 0s;
    }

    &:focus {
      &:before,
      &:after {
        display: block;
      }
    }

    &:hover:not(:focus) {
      &:before,
      &:after {
        display: none;
      }
    }
  }
}
