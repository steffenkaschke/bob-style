<b-form-element-label *ngIf="label && !hideLabelOnFocus"
                      class="bfe-label"
                      [label]="label"
                      [description]="description"
                      [fieldId]="id">
</b-form-element-label>

<div class="bfe-wrap has-suffix"
     [ngClass]="{
        'has-prefix': hasPrefix || showPrefix || valueAvatar,
        focused: panelOpen,
        'panel-open': panelOpen,
        'panel-above': positionClassList['panel-above'],
        'panel-below': positionClassList['panel-below']
      }"
     (click)="openPanel()"
     cdkOverlayOrigin>

  <div *ngIf="(hasPrefix || showPrefix) && !valueAvatar"
       class="bfe-prefix"
       #prefix>
    <ng-content select="[input-prefix]"></ng-content>
  </div>

  <div *ngIf="valueAvatar"
       class="bfe-prefix">
    <b-avatar-image [avatar]="valueAvatar"
                    [border]="size !== formElementSize.smaller"
                    [backgroundColor]="'transparent'"
                    [icon]="valueAvatar.icon"
                    [imageSource]="valueAvatar.imageSource"
                    [size]="size === formElementSize.smaller ? avatarSize.micro : avatarSize.mini"></b-avatar-image>
  </div>

  <span #input
        class="bfe-input trigger-input"
        tabindex="0"
        [b-truncate-tooltip]="1"
        [expectChanges]="true"
        [trustCssVars]="true"
        [type]="tooltipType"
        [tooltipClass]="tooltipClass"
        [attr.data-placeholder]="!displayValue ? (hideLabelOnFocus ? label : placeholder) : null"
        [text]="displayValue"
        (focus)="openPanel()"></span>

  <div class="bfe-suffix">
    <span class="select-chevron b-icon-medium"
          [ngClass]="{'b-icon-chevron-down': !panelOpen, 'b-icon-chevron-up': panelOpen}"></span>
  </div>
</div>

<p b-input-message
   *ngIf="hintMessage || warnMessage || errorMessage"
   [hintMessage]="hintMessage"
   [warnMessage]="warnMessage"
   [errorMessage]="errorMessage"
   [disabled]="disabled"></p>

<ng-template #templateRef>
  <div class="b-select-panel"
       [ngClass]="positionClassList">
    <b-single-list class="b-select-list"
                   [options]="options"
                   [optionsDefault]="optionsDefault"
                   [maxHeight]="(listElHeight[size]||listElHeightDef)*maxHeightItems"
                   [showSingleGroupHeader]="showSingleGroupHeader"
                   [startWithGroupsCollapsed]="startWithGroupsCollapsed"
                   [showNoneOption]="!required && showNoneOption"
                   [readonly]="readonly"
                   [focusOnInit]="true"
                   [listActions]="listActions"
                   [min]="min || (required && 1)"
                   [size]="size"
                   (selectChange)="onSelect($event)"
                   (apply)="onApply()"
                   (cancel)="onCancel()">
      <ng-content footerAction
                  select="[footerAction],[footerActionRight]"></ng-content>
    </b-single-list>
  </div>
</ng-template>
